# WorkerMan支持多少并发

## workerman支持多少并发连接？
workerman使用libevent事件库，并发连接数一般只受系统内存限制，只要内存够，就可以近乎无限的增加并发连接。workerman中每个连接占用大概20K内存（包括系统分配的socket读写缓冲区），12G内存大概能支撑60W并发连接。

**注意：**高并发场景必须安装libevent扩展，参考安装配置章节。另外需要优化linux内核，尤其是进程打开文件数限制，请参考附录内核调优章节。

## workerman支持多少并发请求？
由于每个人并发请求的理解可能不太一致，这里仅提供workerman压测的QPS数据参考。


###测试环境：
* **系统**：debian 6.0 64位
* **内存**：64G
* **cpu**：Intel(R) Xeon(R) CPU E5-2420 0 @ 1.90GHz （2颗物理cpu，6核心，2线程）
* **Workerman**：开启200个Benchark进程
* **压测脚本**：benchmark
* **业务**：发送并返回hello字符串

###普通PHP（版本5.3.10）压测
    短链接（每次请求完成后关闭链接，下次请求建立新的链接）:
        条件： 压测脚本开500个并发线程模拟500个并发用户，每个线程链接Workerman 10W次，每次链接发送1个请求
        结果： 吞吐量：2.3W/S ， cpu利用率：36%

    长链接（每次请求后不关闭链接，下次请求继续复用这个链接）:
        条件： 压测脚本开2000个并发线程模拟2000个并发用户，每个线程链接Workerman 1次，每个链接发送10W请求
        结果： 吞吐量：36.7W/S ， cpu利用率：69%

    内存：每个进程内存稳定在6444K，无内存泄漏


###HHVM环境压测
    短链接（每次请求完成后关闭链接，下次请求建立新的链接）:
        条件： 压测脚本开1000个并发线程模拟1000个并发用户，每个线程链接Workerman 10W次，每次链接发送1个请求
        结果： 吞吐量：3.5W/S ， cpu利用率：35%

    长链接（每次请求后不关闭链接，下次请求继续复用这个链接）:
        条件： 压测脚本开6000个并发线程模拟6000个并发用户，每个线程链接Workerman 1次，每个链接发送10W请求
        结果： 吞吐量：45W/S ， cpu利用率：67%

    内存：HHVM环境每个进程内存稳定在46M，无内存泄漏


###### 以上压测脚本与WorkerMan运行在同一台机器上，并且使用的是较低的php版本
